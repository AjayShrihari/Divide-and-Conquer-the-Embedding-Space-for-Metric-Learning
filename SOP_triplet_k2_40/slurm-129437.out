==========================================
SLURM_JOB_ID = 129437
SLURM_NODELIST = gnode57
SLURM_JOB_GPUS = 0,1,2,3
==========================================
using faiss for clustering
Getting pretrained weights...
Done.
Epoch (Train) 0 Learner -1: Mean Loss [0.1004]
Epoch (Test) 0: NMI [0.8715] | Recall [@1: 0.6431, @10: 0.8039, @100: 0.9091, @1000: 0.9711]
Epoch (Train) 1 Learner -1: Mean Loss [0.0808]
Epoch (Test) 1: NMI [0.8765] | Recall [@1: 0.6641, @10: 0.8218, @100: 0.9193, @1000: 0.9754]
Epoch (Train) 2 Learner -1: Mean Loss [0.0746]
Epoch (Test) 2: NMI [0.8780] | Recall [@1: 0.6741, @10: 0.8285, @100: 0.9253, @1000: 0.9773]
Epoch (Train) 3 Learner -1: Mean Loss [0.0695]
Epoch (Test) 3: NMI [0.8810] | Recall [@1: 0.6872, @10: 0.8391, @100: 0.9296, @1000: 0.9792]
Epoch (Train) 4 Learner -1: Mean Loss [0.0655]
Epoch (Test) 4: NMI [0.8839] | Recall [@1: 0.6983, @10: 0.8459, @100: 0.9323, @1000: 0.9792]
Epoch (Train) 5 Learner -1: Mean Loss [0.0619]
Epoch (Test) 5: NMI [0.8844] | Recall [@1: 0.7016, @10: 0.8505, @100: 0.9349, @1000: 0.9808]
Epoch (Train) 6 Learner -1: Mean Loss [0.0613]
Epoch (Test) 6: NMI [0.8842] | Recall [@1: 0.7051, @10: 0.8508, @100: 0.9365, @1000: 0.9809]
Epoch (Train) 7 Learner -1: Mean Loss [0.0581]
Epoch (Test) 7: NMI [0.8873] | Recall [@1: 0.7144, @10: 0.8563, @100: 0.9384, @1000: 0.9815]
Epoch (Train) 8 Learner -1: Mean Loss [0.0583]
Epoch (Test) 8: NMI [0.8878] | Recall [@1: 0.7152, @10: 0.8594, @100: 0.9402, @1000: 0.9825]
Epoch (Train) 9 Learner -1: Mean Loss [0.0556]
Epoch (Test) 9: NMI [0.8876] | Recall [@1: 0.7145, @10: 0.8581, @100: 0.9389, @1000: 0.9825]
Epoch 10 : Clustering data
[faiss started]
[faiss ended]
num_elemnets_in_cluster: [27095 32425]
Epoch 10 : Done Clustering
Epoch (Train) 10 Learner 0: Mean Loss [0.0329]
Epoch (Test) 10: NMI [0.8818] | Recall [@1: 0.6852, @10: 0.8322, @100: 0.9237, @1000: 0.9753]
Epoch (Train) 10 Learner 1: Mean Loss [0.0354]
Epoch (Test) 10: NMI [0.8816] | Recall [@1: 0.6827, @10: 0.8334, @100: 0.9258, @1000: 0.9769]
Epoch (Train) 11 Learner 0: Mean Loss [0.0288]
Epoch (Test) 11: NMI [0.8845] | Recall [@1: 0.6932, @10: 0.8373, @100: 0.9243, @1000: 0.9757]
Epoch (Train) 11 Learner 1: Mean Loss [0.0305]
Epoch (Test) 11: NMI [0.8829] | Recall [@1: 0.6863, @10: 0.8336, @100: 0.9245, @1000: 0.9763]
Epoch (Train) 12 Learner 0: Mean Loss [0.0283]
Epoch (Test) 12: NMI [0.8826] | Recall [@1: 0.6859, @10: 0.8341, @100: 0.9255, @1000: 0.9775]
Epoch (Train) 12 Learner 1: Mean Loss [0.0264]
Epoch (Test) 12: NMI [0.8806] | Recall [@1: 0.6773, @10: 0.8272, @100: 0.9207, @1000: 0.9755]
Epoch (Train) 13 Learner 0: Mean Loss [0.0251]
Epoch (Test) 13: NMI [0.8845] | Recall [@1: 0.6935, @10: 0.8366, @100: 0.9258, @1000: 0.9764]
Epoch (Train) 13 Learner 1: Mean Loss [0.0267]
Epoch (Test) 13: NMI [0.8807] | Recall [@1: 0.6786, @10: 0.8282, @100: 0.9227, @1000: 0.9759]
Epoch (Train) 14 Learner 0: Mean Loss [0.0240]
Epoch (Test) 14: NMI [0.8835] | Recall [@1: 0.6897, @10: 0.8351, @100: 0.9245, @1000: 0.9766]
Epoch (Train) 14 Learner 1: Mean Loss [0.0262]
Epoch (Test) 14: NMI [0.8826] | Recall [@1: 0.6830, @10: 0.8306, @100: 0.9221, @1000: 0.9750]
Epoch (Train) 15 Learner 0: Mean Loss [0.0233]
Epoch (Test) 15: NMI [0.8833] | Recall [@1: 0.6866, @10: 0.8343, @100: 0.9250, @1000: 0.9763]
Epoch (Train) 15 Learner 1: Mean Loss [0.0251]
Epoch (Test) 15: NMI [0.8838] | Recall [@1: 0.6881, @10: 0.8332, @100: 0.9236, @1000: 0.9755]
Epoch (Train) 16 Learner 0: Mean Loss [0.0249]
Epoch (Test) 16: NMI [0.8824] | Recall [@1: 0.6835, @10: 0.8311, @100: 0.9222, @1000: 0.9760]
Epoch (Train) 16 Learner 1: Mean Loss [0.0250]
Epoch (Test) 16: NMI [0.8829] | Recall [@1: 0.6828, @10: 0.8289, @100: 0.9199, @1000: 0.9744]
Epoch (Train) 17 Learner 0: Mean Loss [0.0234]
Epoch (Test) 17: NMI [0.8818] | Recall [@1: 0.6794, @10: 0.8271, @100: 0.9222, @1000: 0.9757]
Epoch (Train) 17 Learner 1: Mean Loss [0.0251]
Epoch (Test) 17: NMI [0.8811] | Recall [@1: 0.6744, @10: 0.8249, @100: 0.9206, @1000: 0.9752]
Epoch (Train) 18 Learner 0: Mean Loss [0.0233]
Epoch (Test) 18: NMI [0.8838] | Recall [@1: 0.6868, @10: 0.8310, @100: 0.9217, @1000: 0.9743]
Epoch (Train) 18 Learner 1: Mean Loss [0.0259]
Epoch (Test) 18: NMI [0.8846] | Recall [@1: 0.6905, @10: 0.8345, @100: 0.9231, @1000: 0.9751]
Epoch (Train) 19 Learner 0: Mean Loss [0.0220]
Epoch (Test) 19: NMI [0.8825] | Recall [@1: 0.6805, @10: 0.8272, @100: 0.9222, @1000: 0.9754]
Epoch (Train) 19 Learner 1: Mean Loss [0.0240]
Epoch (Test) 19: NMI [0.8803] | Recall [@1: 0.6702, @10: 0.8218, @100: 0.9172, @1000: 0.9735]
Epoch 20 : Clustering data
[faiss started]
[faiss ended]
num_elemnets_in_cluster: [31775 27745]
Epoch 20 : Done Clustering
Epoch (Train) 20 Learner 0: Mean Loss [0.0336]
Epoch (Test) 20: NMI [0.8840] | Recall [@1: 0.6876, @10: 0.8336, @100: 0.9256, @1000: 0.9774]
Epoch (Train) 20 Learner 1: Mean Loss [0.0304]
Epoch (Test) 20: NMI [0.8855] | Recall [@1: 0.6932, @10: 0.8389, @100: 0.9280, @1000: 0.9787]
Epoch (Train) 21 Learner 0: Mean Loss [0.0292]
Epoch (Test) 21: NMI [0.8841] | Recall [@1: 0.6887, @10: 0.8364, @100: 0.9282, @1000: 0.9788]
Epoch (Train) 21 Learner 1: Mean Loss [0.0275]
Epoch (Test) 21: NMI [0.8864] | Recall [@1: 0.6990, @10: 0.8428, @100: 0.9295, @1000: 0.9781]
Epoch (Train) 22 Learner 0: Mean Loss [0.0273]
Epoch (Test) 22: NMI [0.8858] | Recall [@1: 0.6980, @10: 0.8433, @100: 0.9311, @1000: 0.9786]
Epoch (Train) 22 Learner 1: Mean Loss [0.0238]
Epoch (Test) 22: NMI [0.8869] | Recall [@1: 0.7024, @10: 0.8450, @100: 0.9314, @1000: 0.9792]
Epoch (Train) 23 Learner 0: Mean Loss [0.0231]
Epoch (Test) 23: NMI [0.8862] | Recall [@1: 0.7013, @10: 0.8448, @100: 0.9317, @1000: 0.9798]
Epoch (Train) 23 Learner 1: Mean Loss [0.0231]
Epoch (Test) 23: NMI [0.8870] | Recall [@1: 0.7035, @10: 0.8460, @100: 0.9324, @1000: 0.9802]
Epoch (Train) 24 Learner 0: Mean Loss [0.0213]
Epoch (Test) 24: NMI [0.8860] | Recall [@1: 0.7003, @10: 0.8440, @100: 0.9326, @1000: 0.9801]
Epoch (Train) 24 Learner 1: Mean Loss [0.0227]
Epoch (Test) 24: NMI [0.8864] | Recall [@1: 0.7034, @10: 0.8466, @100: 0.9325, @1000: 0.9799]
Epoch (Train) 25 Learner 0: Mean Loss [0.0224]
Epoch (Test) 25: NMI [0.8866] | Recall [@1: 0.7038, @10: 0.8471, @100: 0.9325, @1000: 0.9800]
Epoch (Train) 25 Learner 1: Mean Loss [0.0230]
Epoch (Test) 25: NMI [0.8872] | Recall [@1: 0.7054, @10: 0.8478, @100: 0.9329, @1000: 0.9801]
Epoch (Train) 26 Learner 0: Mean Loss [0.0212]
Epoch (Test) 26: NMI [0.8868] | Recall [@1: 0.7047, @10: 0.8474, @100: 0.9331, @1000: 0.9802]
Epoch (Train) 26 Learner 1: Mean Loss [0.0214]
Epoch (Test) 26: NMI [0.8869] | Recall [@1: 0.7054, @10: 0.8477, @100: 0.9334, @1000: 0.9804]
Epoch (Train) 27 Learner 0: Mean Loss [0.0206]
Epoch (Test) 27: NMI [0.8873] | Recall [@1: 0.7065, @10: 0.8491, @100: 0.9335, @1000: 0.9804]
Epoch (Train) 27 Learner 1: Mean Loss [0.0207]
Epoch (Test) 27: NMI [0.8874] | Recall [@1: 0.7062, @10: 0.8487, @100: 0.9335, @1000: 0.9801]
Epoch (Train) 28 Learner 0: Mean Loss [0.0185]
Epoch (Test) 28: NMI [0.8866] | Recall [@1: 0.7044, @10: 0.8476, @100: 0.9331, @1000: 0.9805]
Epoch (Train) 28 Learner 1: Mean Loss [0.0200]
Epoch (Test) 28: NMI [0.8871] | Recall [@1: 0.7030, @10: 0.8467, @100: 0.9330, @1000: 0.9805]
Epoch (Train) 29 Learner 0: Mean Loss [0.0187]
Epoch (Test) 29: NMI [0.8871] | Recall [@1: 0.7055, @10: 0.8483, @100: 0.9339, @1000: 0.9804]
Epoch (Train) 29 Learner 1: Mean Loss [0.0197]
Epoch (Test) 29: NMI [0.8877] | Recall [@1: 0.7080, @10: 0.8494, @100: 0.9342, @1000: 0.9800]
Epoch 30 : Clustering data
[faiss started]
[faiss ended]
num_elemnets_in_cluster: [36034 23486]
Epoch 30 : Done Clustering
Epoch (Train) 30 Learner 0: Mean Loss [0.0288]
Epoch (Test) 30: NMI [0.8876] | Recall [@1: 0.7079, @10: 0.8499, @100: 0.9341, @1000: 0.9798]
Epoch (Train) 30 Learner 1: Mean Loss [0.0255]
Epoch (Test) 30: NMI [0.8871] | Recall [@1: 0.7064, @10: 0.8489, @100: 0.9341, @1000: 0.9805]
Epoch (Train) 31 Learner 0: Mean Loss [0.0284]
Epoch (Test) 31: NMI [0.8874] | Recall [@1: 0.7053, @10: 0.8496, @100: 0.9347, @1000: 0.9805]
Epoch (Train) 31 Learner 1: Mean Loss [0.0250]
Epoch (Test) 31: NMI [0.8876] | Recall [@1: 0.7068, @10: 0.8494, @100: 0.9343, @1000: 0.9810]
Epoch (Train) 32 Learner 0: Mean Loss [0.0262]
Epoch (Test) 32: NMI [0.8872] | Recall [@1: 0.7035, @10: 0.8479, @100: 0.9339, @1000: 0.9808]
Epoch (Train) 32 Learner 1: Mean Loss [0.0235]
Epoch (Test) 32: NMI [0.8875] | Recall [@1: 0.7072, @10: 0.8502, @100: 0.9349, @1000: 0.9805]
Epoch (Train) 33 Learner 0: Mean Loss [0.0250]
Epoch (Test) 33: NMI [0.8876] | Recall [@1: 0.7064, @10: 0.8502, @100: 0.9347, @1000: 0.9807]
Epoch (Train) 33 Learner 1: Mean Loss [0.0225]
Epoch (Test) 33: NMI [0.8893] | Recall [@1: 0.7106, @10: 0.8524, @100: 0.9356, @1000: 0.9811]
Epoch (Train) 34 Learner 0: Mean Loss [0.0254]
Epoch (Test) 34: NMI [0.8883] | Recall [@1: 0.7096, @10: 0.8503, @100: 0.9355, @1000: 0.9810]
Epoch (Train) 34 Learner 1: Mean Loss [0.0218]
Epoch (Test) 34: NMI [0.8881] | Recall [@1: 0.7100, @10: 0.8511, @100: 0.9353, @1000: 0.9807]
Epoch (Train) 35 Learner 0: Mean Loss [0.0250]
Epoch (Test) 35: NMI [0.8884] | Recall [@1: 0.7094, @10: 0.8507, @100: 0.9363, @1000: 0.9814]
Epoch (Train) 35 Learner 1: Mean Loss [0.0207]
Epoch (Test) 35: NMI [0.8884] | Recall [@1: 0.7096, @10: 0.8514, @100: 0.9361, @1000: 0.9811]
Epoch (Train) 36 Learner 0: Mean Loss [0.0237]
Epoch (Test) 36: NMI [0.8884] | Recall [@1: 0.7084, @10: 0.8504, @100: 0.9356, @1000: 0.9810]
Epoch (Train) 36 Learner 1: Mean Loss [0.0213]
Epoch (Test) 36: NMI [0.8890] | Recall [@1: 0.7104, @10: 0.8524, @100: 0.9358, @1000: 0.9810]
Epoch (Train) 37 Learner 0: Mean Loss [0.0234]
Epoch (Test) 37: NMI [0.8880] | Recall [@1: 0.7078, @10: 0.8499, @100: 0.9355, @1000: 0.9810]
Epoch (Train) 37 Learner 1: Mean Loss [0.0210]
Epoch (Test) 37: NMI [0.8891] | Recall [@1: 0.7112, @10: 0.8521, @100: 0.9363, @1000: 0.9811]
Epoch (Train) 38 Learner 0: Mean Loss [0.0234]
Epoch (Test) 38: NMI [0.8871] | Recall [@1: 0.7063, @10: 0.8485, @100: 0.9351, @1000: 0.9810]
Epoch (Train) 38 Learner 1: Mean Loss [0.0213]
Epoch (Test) 38: NMI [0.8882] | Recall [@1: 0.7096, @10: 0.8509, @100: 0.9355, @1000: 0.9812]
Epoch (Train) 39 Learner 0: Mean Loss [0.0230]
Epoch (Test) 39: NMI [0.8879] | Recall [@1: 0.7090, @10: 0.8512, @100: 0.9363, @1000: 0.9813]
Epoch (Train) 39 Learner 1: Mean Loss [0.0185]
Epoch (Test) 39: NMI [0.8880] | Recall [@1: 0.7097, @10: 0.8510, @100: 0.9363, @1000: 0.9808]
